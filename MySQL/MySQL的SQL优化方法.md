# MySQL的SQL优化方法

by HyperQing


## 关键

**命中合适的索引**

注意：
- MySQL每次select只使用一个索引。
- 如果是in (select)或join（select）子查询语句，则主查询和子查询分别使用一个索引。
- 必须确保SQL中where条件能够命中索引。
- 必须避免全表搜索。

调试工具：

>参考资料：https://segmentfault.com/a/1190000008131735

## 可以做的优化

- 所有字段必须not null，查询is null或is not null无法命中索引
- where 有的查询字段，组合成一个多列索引，再逐个取出影响不大的列。
- 如果某一列的取值区分度低，可能没必要建立索引。
- 索引不宜过多的原因之一是：每个select只能用一个索引，建立无用的索引会占用这个仅有的位置。
- 如果where查询条件很多，但可能不一定同时存在，因此导致索引无法命中，可以考虑为其他条件设置一个默认值，例如创建时间=1970-01-01 00:00:00。
- 按主键查询一条记录时，无必要带上where条件，可以在业务代码中加以优化。

## 比较难做的优化

- 多表join带where条件的count(*)操作。
    - 可以考虑用总数减去速度较快的count()，即100-30=70这种以小求大的操作。